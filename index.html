<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Escala Facil</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìÖ</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/01-main.css" />
    <link rel="stylesheet" href="css/02-layout.css" />
    <link rel="stylesheet" href="css/03-components.css" />
    <link rel="stylesheet" href="css/04-logo.css" />
    <link rel="stylesheet" href="css/05-dark-theme.css" />
    <link rel="stylesheet" href="css/06-responsive.css" />
    <link rel="stylesheet" href="css/07-gerador-escala.css" />
    <link rel="stylesheet" href="css/08-welcome.css" />
    <link rel="stylesheet" href="css/09-editor-manual.css" />
    <link rel="stylesheet" href="css/10-animations.css" />
    <link rel="stylesheet" href="css/11-home-screen.css" />
    <link rel="stylesheet" href="css/12-glow-effects.css" />
    <link rel="stylesheet" href="css/13-animated-fields.css" />
    <link rel="stylesheet" href="css/14-relatorios.css" />
    <link rel="stylesheet" href="css/15-toasts.css" />     
    <link rel="stylesheet" href="css/16-validation.css" /> 
    <link rel="stylesheet" href="css/17-painel-gerenciamento.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/twemoji.min.js" integrity="sha512-NbEKAylAIvinDrSG0pOdV1vT/gN2TqnwP2/RbrI_eR+vPuT+DTC2PZkJBYuOhsXe3L2OOBm2ec_hXPKA3kYi/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>

    <div id="welcome-overlay">
        <div class="welcome-card">

            <div id="welcome-step-1" class="welcome-step">
                <h2 class="welcome-title">Boas-vindas ao <span class="animated-brand-text"
                        style="font-size: inherit;">Escala F√°cil</span>!</h2>
                <p class="welcome-subtitle">Sua nova ferramenta para criar escalas de trabalho de forma inteligente e sem estresse.</p>
                <div class="welcome-options-container">
                    <div class="welcome-option-card" id="welcome-start-fresh">
                        <div class="welcome-option-icon">üöÄ</div>
                        <h3>Come√ßar do Zero</h3>
                        <p>Crie sua configura√ß√£o inicial, cadastre turnos e funcion√°rios, e prepare-se para gerar sua primeira escala.</p>
                    </div>
                    <div class="welcome-option-card" id="welcome-import-backup">
                        <div class="welcome-option-icon">üì•</div>
                        <h3>Importar Backup</h3>
                        <p>J√° usa o Escala F√°cil? Pule a configura√ß√£o e recupere todos os seus dados a partir de um arquivo de backup.</p>
                    </div>
                </div>
            </div>

            <div id="welcome-step-2" class="welcome-step">
                <h2 class="welcome-title">Vamos personalizar sua experi√™ncia</h2>
                <div class="welcome-form-group">
                    <label for="welcome-nome-input" class="welcome-label">Primeiro, como podemos te chamar?</label>
                    <input type="text" id="welcome-nome-input" class="welcome-input"
                        placeholder="Seu nome ou nome da empresa">
                </div>
                <div class="welcome-form-group">
                    <label class="welcome-label">Qual apar√™ncia voc√™ prefere?</label>
                    <div class="toggle-group" id="welcomeThemeToggle">
                        <button type="button" class="toggle-btn" data-value="light">‚òÄÔ∏è Claro</button>
                        <button type="button" class="toggle-btn" data-value="dark">üåô Escuro</button>
                    </div>
                </div>
                <button id="welcome-personalizacao-next" class="welcome-btn welcome-btn-primary">Pr√≥ximo</button>
                <button class="welcome-btn-secondary welcome-btn-back" data-to-step="1">
                    &lt; Voltar</button>
            </div>

            <div id="welcome-step-3" class="welcome-step">
                <h2 class="welcome-title">Como vamos simplificar o seu dia a dia:</h2>
                <ul class="welcome-features-list">
                    <li class="welcome-feature-item"><span>üöÄ</span>
                        <div><strong>Gera√ß√£o Inteligente:</strong> Crie escalas complexas em minutos, n√£o em horas.
                        </div>
                    </li>
                    <li class="welcome-feature-item"><span>‚úÖ</span>
                        <div><strong>Preven√ß√£o de Erros:</strong> Nosso algoritmo evita conflitos e garante o descanso
                            obrigat√≥rio da equipe.</div>
                    </li>
                    <li class="welcome-feature-item"><span>üé®</span>
                        <div><strong>Edi√ß√£o R√°pida e Visual:</strong> Use a Barra de Ferramentas para ajustar, trocar e
                            alocar turnos de forma √°gil e intuitiva.</div>
                    </li>
                    <li class="welcome-feature-item"><span>üìÇ</span>
                        <div><strong>Tudo Centralizado:</strong> Mantenha turnos, cargos e funcion√°rios organizados em
                            um s√≥ lugar.</div>
                    </li>
                </ul>
                <button id="welcome-proposta-next" class="welcome-btn welcome-btn-primary">Pr√≥ximo</button>
                <button class="welcome-btn-secondary welcome-btn-back" data-to-step="2">
                    &lt; Voltar</button>
            </div>

            <div id="welcome-step-4" class="welcome-step">
                <h2 class="welcome-title">Quase pronto!</h2>
                <p class="welcome-subtitle">Para continuar, por favor, leia e aceite nossos termos de uso e pol√≠tica de privacidade.</p>
                <div class="welcome-terms-container">
                    <div class="info-card" id="welcome-terms-card">
                        <span class="icon"></span>
                        <span class="text">Termos de Uso</span>
                    </div>
                    <div class="info-card" id="welcome-privacy-card">
                        <span class="icon"></span>
                        <span class="text">Pol√≠tica de Privacidade</span>
                    </div>
                </div>
                <button id="welcome-finish-btn" class="success" disabled>Concluir e Come√ßar a
                    Usar!</button>
                <button class="welcome-btn-secondary welcome-btn-back" data-to-step="3">
                    &lt; Voltar</button>
            </div>

            <div class="welcome-progress-indicator">
                <span class="progress-dot" data-step="1"></span>
                <span class="progress-dot" data-step="2"></span>
                <span class="progress-dot" data-step="3"></span>
                <span class="progress-dot" data-step="4"></span>
            </div>

        </div>
    </div>
    <nav id="sidebar">
        <a href="#" class="app-brand" onclick="go('home')">
            <span class="logo-compact">EF</span>
            <span class="logo-full animated-brand-text">Escala F√°cil</span>
        </a>

        <div class="sidebar-links">
            <button class="tab-btn active" data-page="home">
                <span class="tab-icon">üè†</span>
                <span class="tab-text">In√≠cio</span>
            </button>
            <button class="tab-btn" data-page="turnos">
                <span class="tab-icon">üïí</span>
                <span class="tab-text">Turnos</span>
            </button>
            <button class="tab-btn" data-page="cargos">
                <span class="tab-icon">üè•</span> <span class="tab-text">Cargos</span>
            </button>
            <button class="tab-btn" data-page="funcionarios">
                <span class="tab-icon">üë®‚Äç‚öïÔ∏è</span> <span class="tab-text">Funcion√°rios</span>
            </button>
            <button class="tab-btn" data-page="equipes">
                <span class="tab-icon">ü§ù</span> <span class="tab-text">Equipes</span>
            </button>
            <button class="tab-btn" data-page="gerar-escala">
                <span class="tab-icon">‚ú®</span>
                <span class="tab-text">Gera√ß√£o Autom√°tica</span>
            </button>
            <button class="tab-btn" data-page="escalas-salvas">
                <span class="tab-icon">üóÇÔ∏è</span>
                <span class="tab-text">Escalas Salvas</span>
            </button>
            <button class="tab-btn" data-page="relatorios">
                <span class="tab-icon">üìä</span>
                <span class="tab-text">Relat√≥rios</span>
            </button>
        </div>

        <button class="tab-btn" data-page="configuracoes" title="Configura√ß√µes">
            <span class="tab-icon">‚öôÔ∏è</span>
            <span class="tab-text">Configura√ß√µes</span>
        </button>
    </nav>

    <main class="container">
        <header id="main-header">
            <h1 id="page-title"></h1>
            <div class="header-user-info">
                <h2 id="welcomeTitle" class="welcome-title"></h2>
                <button id="header-settings-btn" class="header-action-btn" title="Configura√ß√µes" aria-label="Abrir Configura√ß√µes">‚öôÔ∏è</button>
            </div>
        </header>

        <section id="page-home" class="page active">
            
            <h2 class="home-section-title">Cadastros Essenciais</h2>
            <div class="grid-4-col">
                <a class="card home-card" data-goto="turnos">
                    <span class="card-step">Passo 1</span>
                    <h3>üïí Turnos</h3>
                    <p id="home-turnos-count" class="home-card-count"></p>
                    <p class="home-card-desc">Crie os hor√°rios de trabalho da sua opera√ß√£o.</p>
                </a>
                <a class="card home-card" data-goto="cargos">
                    <span class="card-step">Passo 2</span>
                    <h3>üè• Cargos</h3>
                    <p id="home-cargos-count" class="home-card-count"></p>
                    <p class="home-card-desc">Defina os cargos e associe os turnos que podem cumprir.</p>
                </a>
                <a class="card home-card" data-goto="funcionarios">
                    <span class="card-step">Passo 3</span>
                    <h3>üë®‚Äç‚öïÔ∏è Funcion√°rios</h3>
                    <p id="home-funcionarios-count" class="home-card-count"></p>
                    <p class="home-card-desc">Adicione seus funcion√°rios, cargos e disponibilidade.</p>
                </a>
                <a class="card home-card" data-goto="equipes">
                    <span class="card-optional-step">Opcional</span>
                    <h3>ü§ù Equipes</h3>
                    <p id="home-equipes-count" class="home-card-count"></p>
                    <p class="home-card-desc">Crie grupos fixos de funcion√°rios para escalas de rod√≠zio.</p>
                </a>
            </div>

            <h2 class="home-section-title">Crie e Gerencie suas Escalas</h2>
            <div class="grid-3-col">
                <a class="card home-card" data-goto="gerar-escala">
                    <h3>‚ú® Gera√ß√£o Autom√°tica</h3>
                    <p class="home-card-desc">O sistema distribui os funcion√°rios de forma otimizada e inteligente.</p>
                </a>
                 <a class="card home-card" data-goto="escalas-salvas">
                    <h3>üóÇÔ∏è Escalas Salvas</h3>
                    <p class="home-card-desc">Acesse e gerencie as escalas que voc√™ j√° salvou.</p>
                </a>
                <a class="card home-card" data-goto="relatorios">
                    <h3>üìä Relat√≥rios</h3>
                    <p class="home-card-desc">Analise m√©tricas e a distribui√ß√£o de horas das suas escalas.</p>
                </a>
            </div>

        </section>

        <section id="page-turnos" class="page">
            <div class="card painel-gerenciamento">
                <div class="painel-header">
                    <div class="painel-tabs">
                        <button class="painel-tab-btn active" data-tab="gerenciar">Gerenciar Cadastrados</button>
                        <button class="painel-tab-btn" data-tab="formulario">Novo Turno</button>
                    </div>
                    <div class="painel-actions">
                        <button class="primary btn-add-new" data-action="add-new">‚ûï Adicionar Novo Turno</button>
                    </div>
                </div>
                <div class="painel-content">
                    <div class="painel-tab-content active" data-tab-content="gerenciar">
                        <div class="form-row"><input type="search" id="filtroTurnos" placeholder="üîé Buscar turno..." style="width: 100%;" /></div>
                        <table class="table" id="tblTurnos">
                            <thead>
                                <tr>
                                    <th>Cor</th>
                                    <th>Nome</th>
                                    <th>Sigla</th>
                                    <th>In√≠cio</th>
                                    <th>Fim</th>
                                    <th>Almo√ßo</th>
                                    <th>Carga</th>
                                    <th>Descanso</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="painel-tab-content" data-tab-content="formulario">
                        <div class="animated-field" style="max-width: 50%; margin-bottom: 12px;">
                            <input id="turnoNome" type="text" placeholder=" " />
                            <label for="turnoNome">Nome do Turno</label>
                        </div>
                        <fieldset class="fieldset-wrapper">
                            <legend>√çcone e Cor</legend>
                            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 24px; align-items: center;">
                                <div class="animated-field">
                                    <input id="turnoSigla" type="text" placeholder=" " maxlength="2" />
                                    <label for="turnoSigla">Sigla (2 letras)</label>
                                </div>
                                <div id="turnoCorContainer" style="display: flex; align-items: center; gap: 12px;">
                                    <label class="form-label" style="margin: 0; flex-shrink: 0;">Cor</label>
                                    <div id="turnoCorPalette" class="color-palette" style="flex-grow: 1;"></div>
                                    <input type="hidden" id="turnoCorHidden" value="#e2e8f0">
                                </div>
                            </div>
                        </fieldset>
                        <fieldset class="fieldset-wrapper">
                            <legend>Carga Hor√°ria</legend>
                            <div class="form-row form-row-vcenter">
                                <label>In√≠cio <input id="turnoInicio" type="time" /></label>
                                <label>Fim <input id="turnoFim" type="time" /></label>
                                <label>Dia de T√©rmino
                                    <select id="turnoFimDia">
                                        <option value="0">Mesmo dia</option>
                                        <option value="1">Dia seguinte</option>
                                        <option value="2">2 dias depois</option>
                                        <option value="3">3 dias depois</option>
                                    </select>
                                </label>
                                <div class="animated-field">
                                    <input id="turnoAlmoco" type="number" min="0" step="5" placeholder=" " />
                                    <label for="turnoAlmoco">Almo√ßo (min)</label>
                                </div>
                                <span id="turnoCarga" class="muted badge">Carga: 00:00</span>
                                <div id="turnoViraDia" class="badge-explanation hidden">
                                    <span>üåô</span>
                                    <span>Turno Noturno</span>
                                </div>
                                <div id="turnoDeLongaDuracao" class="badge-explanation hidden">
                                    <span>üîÅ</span>
                                    <span>Longa Dura√ß√£o</span>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend>Descanso Obrigat√≥rio</legend>
                            <div class="grid-2-col-uneven">
                                <div class="form-row-aligned">
                                    <div class="toggle-group" id="descansoToggleGroup">
                                        <button type="button" class="toggle-btn" data-value="nao">N√£o</button>
                                        <button type="button" class="toggle-btn" data-value="sim">Sim</button>
                                        <input type="hidden" id="descansoObrigatorioHidden" value="nao">
                                    </div>
                                    <div id="descansoHorasGroup" class="expandable-content hidden-height">
                                        <div class="animated-field" style="width: 150px;">
                                            <input type="number" id="turnoDescansoHoras" min="1" max="100" placeholder=" " disabled />
                                            <label for="turnoDescansoHoras">Horas</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="explanation-box">
                                    <div>Define o intervalo m√≠nimo em horas que um funcion√°rio precisa descansar ap√≥s concluir este turno, antes de poder iniciar qualquer outro.</div>
                                </div>
                            </div>
                        </fieldset>
                        <div class="form-row form-row-center">
                            <button id="btnSalvarTurno" class="success">üíæ Salvar Turno</button>
                            <button id="btnCancelarTurno" class="purple">üóëÔ∏è Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-cargos" class="page">
            <div class="card painel-gerenciamento">
                <div class="painel-header">
                    <div class="painel-tabs">
                        <button class="painel-tab-btn active" data-tab="gerenciar">Gerenciar Cadastrados</button>
                        <button class="painel-tab-btn" data-tab="formulario">Novo Cargo</button>
                    </div>
                    <div class="painel-actions">
                        <button class="primary btn-add-new" data-action="add-new">‚ûï Adicionar Novo Cargo</button>
                    </div>
                </div>
                <div class="painel-content">
                    <div class="painel-tab-content active" data-tab-content="gerenciar">
                        <div class="form-row"><input type="search" id="filtroCargos" placeholder="üîé Buscar cargo..." style="width: 100%;" /></div>
                        <table class="table" id="tblCargos">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Turnos</th>
                                    <th>Funcionamento</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="painel-tab-content" data-tab-content="formulario">
                        <div class="grid-3-col">
                            <div class="animated-field" style="grid-column: 1 / 3;">
                                <input id="cargoNome" type="text" placeholder=" " />
                                <label for="cargoNome">Nome do Cargo</label>
                            </div>
                        </div>
                        <fieldset>
                            <legend>Turnos Associados</legend>
                            <div id="cargoTurnosContainer" class="check-container"></div>
                        </fieldset>
                        <fieldset id="cargoRegrasFieldset">
                            <legend>Regras de Funcionamento do Cargo</legend>
                            <div class="grid-2-col">
                                <div class="form-section-column">
                                    <label class="form-label">Dias em que o cargo opera:</label>
                                    <div id="cargoDiasContainer" class="dias-semana-container"></div>
                                    <div style="text-align: left; margin-top: 8px; display: flex; gap: 8px;">
                                        <button type="button" id="btnToggleDiasSemanaCargo" class="secondary" style="padding: 4px 12px; font-size: 0.8rem;">Dias de semana</button>
                                        <button type="button" id="btnToggleTodosDiasCargo" class="secondary" style="padding: 4px 12px; font-size: 0.8rem;">Todos os dias</button>
                                    </div>
                                </div>
                                <div class="form-section-column">
                                    <label class="form-label">Hor√°rio de opera√ß√£o:</label>
                                    <div class="form-row-aligned">
                                        <div class="toggle-group" id="cargoHorarioToggle">
                                            <button type="button" class="toggle-btn" data-value="automatico">Autom√°tico</button>
                                            <button type="button" class="toggle-btn" data-value="24h">24 Horas</button>
                                            <button type="button" class="toggle-btn" data-value="parcial">Hor√°rio Definido</button>
                                            <input type="hidden" id="cargoTipoHorarioHidden" value="automatico">
                                        </div>
                                        <div id="cargoHorarioInputs" class="form-row expandable-content">
                                            <label>In√≠cio <input id="cargoInicio" type="time" /></label>
                                            <label>Fim <input id="cargoFim" type="time" /></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="cargoRegrasExplicacao" class="explanation-box">
                                <div>Defina os dias e a faixa de hor√°rio em que este cargo precisa de cobertura. Isso ajudar√° o gerador de escala a entender a demanda.</div>
                            </div>
                        </fieldset>
                        <div class="form-row form-row-center">
                            <button id="btnSalvarCargo" class="success">üíæ Salvar Cargo</button>
                            <button id="btnCancelarCargo" class="purple">üóëÔ∏è Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-funcionarios" class="page">
             <div class="card painel-gerenciamento">
                <div class="painel-header">
                    <div class="painel-tabs">
                        <button class="painel-tab-btn active" data-tab="gerenciar">Gerenciar Cadastrados</button>
                        <button class="painel-tab-btn" data-tab="formulario">Novo Funcion√°rio</button>
                    </div>
                    <div class="painel-actions">
                        <button class="primary btn-add-new" data-action="add-new">‚ûï Adicionar Novo Funcion√°rio</button>
                    </div>
                </div>
                <div class="painel-content">
                    <div class="painel-tab-content active" data-tab-content="gerenciar">
                        <div class="form-row">
                            <input type="search" id="filtroFuncionarios" placeholder="üîé Buscar funcion√°rio..." style="width: 100%;" />
                        </div>
                        <table class="table" id="tblFuncionarios">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Cargo</th>
                                    <th>Turnos</th>
                                    <th>Contrato</th>
                                    <th>Carga Hor√°ria</th>
                                    <th>H. Extra</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="painel-tab-content" data-tab-content="formulario">
                        <div class="grid-2-col" style="gap: 24px; align-items: flex-start; margin-bottom: 0;">
                            <div class="animated-field">
                                <input id="funcNome" type="text" placeholder=" " />
                                <label for="funcNome">Nome Completo</label>
                            </div>
                            <div class="animated-field">
                                <input id="funcDocumento" type="text" placeholder=" " />
                                <label for="funcDocumento">Documento (Opcional)</label>
                            </div>
                        </div>
                        <fieldset>
                            <legend>Cargo e Meta de Trabalho</legend>
                            <div class="grid-3-col" style="align-items: end; gap: 24px 32px;">
                                <div class="form-group" style="grid-column: 1 / 2;">
                                   <label class="form-label" for="funcCargo">Cargo</label>
                                   <select id="funcCargo"></select>
                                </div>
                                <div style="grid-column: 2 / 4;">
                                    <div class="form-row" style="margin: 0; align-items: end; gap: 24px;">
                                        <div class="form-group" style="flex-shrink: 0;">
                                            <label class="form-label">Medir Meta por</label>
                                            <div class="toggle-group" id="medicaoCargaToggleGroup">
                                                <button type="button" class="toggle-btn" data-value="horas">Horas</button>
                                                <button type="button" class="toggle-btn" data-value="turnos">Turnos</button>
                                                <input type="hidden" id="funcMedicaoCarga" value="horas">
                                            </div>
                                        </div>
                                        <div class="form-group" style="flex-shrink: 0;">
                                            <label class="form-label">Per√≠odo da Meta</label>
                                            <div class="toggle-group" id="periodoHorasToggleGroup">
                                                <button type="button" class="toggle-btn" data-value="semanal">Semanal</button>
                                                <button type="button" class="toggle-btn" data-value="mensal">Mensal</button>
                                                <input type="hidden" id="funcPeriodoHoras" value="semanal">
                                            </div>
                                        </div>
                                        <div class="animated-field" style="min-width: 150px; flex-grow: 1;">
                                            <input id="funcCargaHoraria" type="number" placeholder=" " min="1" />
                                            <label for="funcCargaHoraria" id="funcCargaHorariaLabel">Carga Hor√°ria</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="funcMetaExplicacao" class="explanation-box" style="margin-top: 16px;">
                                <div>Defina a meta de trabalho para ver um resumo.</div>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend>Detalhes do Contrato</legend>
                            <div class="grid-2-col">
                                <div class="form-section-column">
                                     <div class="form-section-header"><label>Tipo de Contrato</label></div>
                                     <div class="toggle-group" id="contratoToggleGroup">
                                        <button type="button" class="toggle-btn" data-value="clt">CLT / Concursado</button>
                                        <button type="button" class="toggle-btn" data-value="pj">Prestador de Servi√ßo</button>
                                        <input type="hidden" id="funcContrato" value="clt">
                                    </div>
                                    <div id="contratoExplicacao" class="explanation-box" style="margin-top: 12px;">
                                        <div><strong>CLT / Concursado:</strong> V√≠nculo empregat√≠cio tradicional. As regras de descanso obrigat√≥rio s√£o aplicadas.</div>
                                    </div>
                                </div>
                                <div class="form-section-column">
                                    <div class="form-section-header">
                                        <label>Pode exceder a meta?</label>
                                    </div>
                                    <div class="toggle-group" id="horaExtraToggleGroup">
                                        <button type="button" class="toggle-btn" data-value="nao">N√£o</button>
                                        <button type="button" class="toggle-btn" data-value="sim">Sim</button>
                                        <input type="hidden" id="funcHoraExtra" value="nao">
                                    </div>
                                     <div class="explanation-box" style="margin-top: 12px;">
                                        <div>Se habilitado, o algoritmo poder√° escalar este funcion√°rio al√©m de sua meta (seja em horas ou em turnos).</div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset id="funcTurnosFieldset">
                            <legend>Disponibilidade e Prefer√™ncias de Turnos</legend>
                            <div class="explanation-box" style="margin-bottom: 16px;">
                                <div>Clique no nome do turno para ativ√°-lo (todos os dias como 'Dispon√≠vel'). Depois, clique em cada dia da semana para alternar entre: <span class="badge-explanation" style="background: var(--bg); border-width: 2px;">Indispon√≠vel</span> ‚Üí <span class="badge-explanation dia-disponivel">Dispon√≠vel</span> ‚Üí <span class="badge-explanation dia-preferencial">Preferencial</span>.</div>
                            </div>
                            <div id="funcTurnosContainer" class="turno-disponibilidade-grid">
                                <div class="turno-placeholder">
                                    <p>Selecione um cargo para ver os turnos dispon√≠veis.</p>
                                </div>
                            </div>
                        </fieldset>
                        <div class="form-row form-row-center">
                            <button id="btnSalvarFunc" class="success">üíæ Salvar Funcion√°rio</button>
                            <button id="btnCancelarFunc" class="purple">üóëÔ∏è Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-equipes" class="page">
            <div class="card painel-gerenciamento">
                <div class="painel-header">
                    <div class="painel-tabs">
                        <button class="painel-tab-btn active" data-tab="gerenciar">Gerenciar Cadastrados</button>
                        <button class="painel-tab-btn" data-tab="formulario">Nova Equipe</button>
                    </div>
                    <div class="painel-actions">
                        <button class="primary btn-add-new" data-action="add-new">‚ûï Adicionar Nova Equipe</button>
                    </div>
                </div>
                <div class="painel-content">
                    <div class="painel-tab-content active" data-tab-content="gerenciar">
                         <div class="form-row"><input type="search" id="filtroEquipes" placeholder="üîé Buscar equipe..." style="width: 100%;" /></div>
                        <table class="table" id="tblEquipes">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Cargo</th>
                                    <th>Turno</th>
                                    <th>Membros</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="painel-tab-content" data-tab-content="formulario">
                        <div class="grid-2-col-uneven" style="gap: 32px; align-items: start; margin-bottom: 0;">
                            <div>
                                <div class="animated-field" style="margin-bottom: 16px;">
                                    <input id="equipeNome" type="text" placeholder=" " />
                                    <label for="equipeNome">Nome da Equipe</label>
                                </div>
                                <div class="form-row-aligned" style="gap: 16px;">
                                     <fieldset class="fieldset-wrapper" style="margin:0; flex: 1;">
                                        <legend>Cargo</legend>
                                        <select id="equipeCargo"></select>
                                    </fieldset>
                                     <fieldset class="fieldset-wrapper" style="margin:0; flex: 1;">
                                        <legend>Turno</legend>
                                        <select id="equipeTurno" disabled></select>
                                    </fieldset>
                                </div>
                            </div>
                            <fieldset>
                                <legend>Membros da Equipe</legend>
                                <div id="equipeFuncionariosContainer" class="check-container">
                                    <p class="muted">Selecione um cargo e um turno para listar os funcion√°rios eleg√≠veis.</p>
                                </div>
                            </fieldset>
                        </div>
                         <div class="grid-2-col" style="align-items: start; margin-top: 16px; margin-bottom: 0;">
                            <div class="explanation-box">
                                <div><strong>Como as Equipes Funcionam?</strong><br>Crie grupos fixos de funcion√°rios que sempre trabalhar√£o juntos. Isso √© ideal para padr√µes de rod√≠zio como 12x36, 2x2, etc. Ao escalar uma equipe, todos os seus membros s√£o alocados automaticamente.</div>
                            </div>
                             <div class="explanation-box">
                                <div><strong>E os Funcion√°rios Sem Equipe?</strong><br>Qualquer funcion√°rio que n√£o pertencer a uma equipe continuar√° sendo alocado individualmente pelo algoritmo para preencher as vagas restantes e complementar a cobertura dos turnos.</div>
                            </div>
                        </div>
                        <div class="form-row form-row-center">
                            <button id="btnSalvarEquipe" class="success">üíæ Salvar Equipe</button>
                            <button id="btnCancelarEquipe" class="purple">üóëÔ∏è Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-gerar-escala" class="page">
            <div id="gerador-wizard-container">
                
                <div id="gerador-wizard-passo1" class="wizard-step card card-animated-border">
                    <div class="wizard-header">
                        <h3>Passo 1: Defina o B√°sico</h3>
                    </div>
                    <div class="passo1-grid">
                        <fieldset class="regras-fieldset">
                            <legend>Informa√ß√µes Essenciais</legend>
                            <select id="gerar-escCargo" style="width: 100%; margin-bottom: 16px;"></select>
                            <fieldset class="fieldset-wrapper">
                                <legend>Per√≠odo da Escala</legend>
                                <div class="form-row form-row-vcenter">
                                    <label>In√≠cio <input type="date" id="gerar-escIni" class="input-sm"></label>
                                    <label>Fim <input type="date" id="gerar-escFim" class="input-sm" disabled></label>
                                </div>
                            </fieldset>
                            <span id="gerar-escResumoDias" class="dias-resumo-box">Selecione o per√≠odo para ver a dura√ß√£o da escala.</span>
                        </fieldset>
                        <div class="wizard-tips-container">
                             <button id="btn-gerador-goto-passo2" class="primary hidden" style="font-size: 1.2rem; padding: 12px 28px;">Vamos come√ßar</button>
                        </div>
                    </div>
                </div>

                <div id="gerador-wizard-passo2" class="wizard-step card card-animated-border">
                    <div class="wizard-header">
                        <button class="secondary button-voltar" data-wizard-back-to="1" data-wizard="gerador"><b>&lt;</b> Voltar</button>
                        <h3>Passo 2: Marque Feriados e Folgas Gerais</h3>
                        <button id="btn-gerador-goto-passo3" class="primary">Pr√≥ximo Passo <b>&gt;</b></button>
                    </div>
                    <div id="holiday-step-container" class="passo2-holiday-grid">
                        <div id="holiday-calendars-container" class="calendars-wrapper">
                        </div>
                        <div id="holiday-editor-container" class="holiday-editor-wrapper">
                        </div>
                        <div id="holiday-list-wrapper"></div>
                    </div>
                </div>

                <div id="gerador-wizard-passo3" class="wizard-step card card-animated-border">
                    <div class="wizard-header">
                        <button class="secondary button-voltar" data-wizard-back-to="2" data-wizard="gerador"><b>&lt;</b> Voltar</button>
                        <h3>Passo 3: Configure F√©rias e Afastamentos</h3>
                        <button id="btn-gerador-goto-passo4" class="primary">Pr√≥ximo Passo <b>&gt;</b></button>
                    </div>
                    <div id="gerador-excecoes-funcionarios-container"></div>
                </div>

                <div id="gerador-wizard-passo4" class="wizard-step card card-animated-border">
                    <div class="wizard-header">
                        <button class="secondary button-voltar" data-wizard-back-to="3" data-wizard="gerador"><b>&lt;</b> Voltar</button>
                        <h3>Passo 4: Defina a Cobertura e Regras Finais</h3>
                        <button id="btnGerarEscala" class="primary">‚ú® Gerar Escala ‚ú®</button>
                    </div>
                    <div class="passo2-grid">
                        <fieldset class="regras-fieldset">
                            <legend>Cobertura de Turnos</legend>
                            <div id="gerador-cobertura-turnos-container"></div>
                        </fieldset>
                        <fieldset class="regras-fieldset">
                            <legend>Regras para Funcion√°rios</legend>
                            <div class="explanation-box" style="margin-bottom: 16px;">
                               <div>Estas regras se aplicam a todos os funcion√°rios alocados individualmente pelo gerador.</div>
                            </div>
                            <div class="regra-item">
                                <div class="animated-field">
                                    <input type="number" id="gerar-maxDiasConsecutivos" value="6" min="1" placeholder=" " />
                                    <label for="gerar-maxDiasConsecutivos">M√°x. dias de trabalho consecutivos</label>
                                </div>
                            </div>
                            <div class="regra-item">
                                <div class="animated-field">
                                    <input type="number" id="gerar-minFolgasSabados" value="1" min="0" placeholder=" " />
                                    <label for="gerar-minFolgasSabados">M√≠n. S√°bados de folga por m√™s</label>
                                </div>
                            </div>
                            <div class="regra-item">
                                <div class="animated-field">
                                    <input type="number" id="gerar-minFolgasDomingos" value="1" min="0" placeholder=" " />
                                    <label for="gerar-minFolgasDomingos">M√≠n. Domingos de folga por m√™s</label>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </div>
            
            <div id="gerador-escalaView" class="hidden">
                <div class="card">
                     <div class="form-row" style="margin: 0; justify-content: space-between; align-items: center;">
                        <button id="btnExcluirEscalaGerador" class="danger" style="margin: 0;">üî• Descartar</button>
                        
                        <div id="gerador-escala-title-container" class="escala-title-container">
                            <h2 class="escala-title-text" id="gerador-escalaViewTitle"></h2>
                            <input type="text" class="escala-title-input" id="gerador-escalaViewTitleInput" />
                            <button class="escala-title-edit-btn" id="gerador-escala-edit-title-btn" title="Editar nome da escala" aria-label="Editar nome da escala">‚úèÔ∏è</button>
                        </div>
                        
                        <div class="bottom-actions-container" style="margin: 0;">
                            <button id="btnSalvarEscalaGerador" class="success">üíæ Salvar Altera√ß√µes</button>
                        </div>
                    </div>
                </div>
                <div class="card card-lista">
                    <div id="gerador-escalaTabelaWrap"></div>
                </div>
                <div id="gerador-painel-escala" class="card card-lista">
                    <div class="painel-header">
                        <h3 class="painel-title"></h3>
                        <div class="painel-tabs"></div>
                    </div>
                    <div class="painel-content"></div>
                </div>
            </div>
        </section>
        
        <section id="page-escalas-salvas" class="page">
            <div id="listaEscalasContainer" class="card card-lista">
                <h2>Lista de Escalas</h2>
                <div class="form-row" style="margin-top:0; align-items: flex-end;">
                    <label style="flex-grow: 1; max-width: 400px;">Filtrar por Cargo:
                        <select id="filtroEscalasCargo"></select>
                    </label>
                </div>
                <div id="listaEscalas"></div>
            </div>

            <div id="escalaSalvaView" class="hidden">
                 <div class="card">
                    <div class="form-row" style="margin: 0; justify-content: space-between; align-items: center;">
                        <button id="btnVoltarParaLista" class="secondary button-voltar" style="margin: 0;"><b>&lt;</b> Voltar para a Lista</button>
                        <h2 id="escalaSalvaViewTitle" style="margin: 0; font-size: 1.5rem;"></h2>
                        <div style="display: flex; gap: 8px;">
                            <button id="btnEditarEscalaSalva" class="secondary">‚úèÔ∏è Editar Escala</button>
                            <button id="btnExcluirEscalaSalva" class="danger">üî• Excluir</button>
                            <button id="btnExportarPDF" class="primary">üñ®Ô∏è Exportar para PDF</button>
                        </div>
                    </div>
                </div>
                <div class="card card-lista">
                    <div id="escalaSalvaTabelaWrap"></div>
                </div>
                <div id="salva-painel-escala" class="card card-lista">
                     <div class="painel-header">
                        <h3 class="painel-title"></h3>
                        <div class="painel-tabs"></div>
                    </div>
                    <div class="painel-content"></div>
                </div>
            </div>
        </section>

        <section id="page-relatorios" class="page">
            <div class="card card-lista">
                <h2>Analisar Relat√≥rio de Escala</h2>
                <div class="form-row" style="align-items: flex-end; margin-top: 0;">
                    <label style="flex-grow: 1; max-width: 400px;">Selecione o Cargo:
                        <select id="relatorioCargoSelect"></select>
                    </label>
                </div>
                <div id="relatoriosEscalaListContainer"></div>
            </div>

            <div id="relatorios-container" class="hidden">
                <div class="relatorios-grid-3" style="margin-top: 24px; gap: 16px;">
                    <div class="card summary-card-small">
                        <h4>Total de Horas Extras</h4>
                        <p id="summary-horas-extras">0h</p>
                    </div>
                    <div class="card summary-card-small">
                        <h4>Total de Funcion√°rios</h4>
                        <p id="summary-total-funcs">0</p>
                    </div>
                    <div class="card card-lista">
                        <h2>Distribui√ß√£o de Turnos</h2>
                        <div class="chart-container">
                            <canvas id="turnosChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="grid-2-col" style="margin-top: 16px; align-items: start;">
                    <div class="card card-lista" id="horasChartContainerWrapper" style="display: none;">
                        <h2>Horas Trabalhadas vs. Meta</h2>
                        <div class="chart-container" style="height:350px">
                            <canvas id="horasChart"></canvas>
                        </div>
                    </div>
                    <div class="card card-lista" id="turnosChartContainerWrapper" style="display: none;">
                        <h2>Turnos Realizados vs. Meta</h2>
                        <div class="chart-container" style="height:350px">
                            <canvas id="metaTurnosChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card card-lista" style="margin-top: 16px;">
                    <h2>Folgas de Fim de Semana</h2>
                    <div class="grid-2-col" style="gap: 24px; align-items: start;">
                        <div>
                            <h4>S√°bados</h4>
                            <div class="chart-container" style="height:350px">
                                <canvas id="folgasSabadoChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h4>Domingos</h4>
                            <div class="chart-container" style="height:350px">
                                <canvas id="folgasDomingoChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid-2-col" style="margin-top: 16px; gap: 16px; align-items: start;">
                    <div class="card card-lista">
                        <h2>Distribui√ß√£o de Turnos por Funcion√°rio</h2>
                        <div id="distribuicaoTurnosContainer"></div>
                    </div>
                    <div class="card card-lista">
                        <h2>Resumo de Aus√™ncias (F√©rias/Folgas)</h2>
                        <div id="ausenciasContainer"></div>
                    </div>
                </div>
            </div>
            <div id="relatorios-empty-state"></div>
        </section>

        <section id="page-configuracoes" class="page">
            <div class="config-grid">
                <div class="card">
                    <h2>Prefer√™ncias</h2>
                    <div class="grid-2-col" style="align-items: center; gap: 32px; margin-bottom: 0;">
                        <div class="form-row" style="border: none; padding: 0; margin: 0; flex-direction: column; align-items: stretch;">
                            <div class="animated-field" style="width: 100%;">
                                <input type="text" id="configNome" placeholder=" " />
                                <label for="configNome">Nome (Empresa ou Pessoal)</label>
                            </div>
                        </div>
                        <div class="form-row" style="border: none; padding: 0; margin: 0; justify-content: flex-end; align-items: center;">
                            <div class="toggle-group" id="themeToggleGroup">
                                <button type="button" class="toggle-btn" data-value="light">‚òÄÔ∏è Claro</button>
                                <button type="button" class="toggle-btn" data-value="dark">üåô Escuro</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-row" style="padding-top: 24px; justify-content: flex-end; border-top: 1px solid var(--border); margin-top: 16px;">
                        <button id="btnSalvarConfig" class="success">üíæ Salvar</button>
                    </div>
                </div>
                <div class="card">
                    <h2>Sobre e Suporte</h2>
                    <p class="muted">Precisa de ajuda ou quer saber mais sobre o software?</p>
                    <div class="config-terms-container">
                        <div class="config-terms-row">
                            <div class="info-card" id="config-terms-card">
                                <span class="icon"></span>
                                <span class="text">Termos de Uso</span>
                            </div>
                            <div class="info-card" id="config-privacy-card">
                                <span class="icon"></span>
                                <span class="text">Pol√≠tica de Privacidade</span>
                            </div>
                        </div>
                        <div class="config-terms-row">
                            <div class="info-card" id="config-shortcuts-card" style="flex: 1;">
                                <span class="text">‚å®Ô∏è Atalhos de Teclado</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="config-grid">
                <div class="card">
                    <h2>Backup e Restaura√ß√£o de Dados</h2>
                    <div class="explanation-box" style="margin-bottom: 16px;">
                        <div>
                            <strong>Aten√ß√£o:</strong> Seus dados (turnos, funcion√°rios, etc.) s√£o salvos apenas neste navegador. Use as op√ß√µes abaixo para criar um arquivo de backup e restaur√°-lo se necess√°rio (ex: em outro computador ou ap√≥s limpar os dados do navegador).
                        </div>
                    </div>
                    <div class="form-row">
                        <button id="btn-export-data" class="primary">üì§ Exportar Todos os Dados</button>
                        <button id="btn-import-data" class="secondary">üì• Importar de um Arquivo</button>
                    </div>
                </div>
                <div class="card card-animated-border card-animated-border--cat-colors">
                    <div class="support-card-content">
                        <div class="support-card-col-left">
                            <h2 class="animated-brand-text animated-brand-text--cat-colors" style="font-size: 1.5rem; margin-bottom: 16px;">üêà Gostou do app?</h2>
                            <p class="muted" style="text-align: left;">
                                Este √© um projeto independente, feito com muito carinho e sob a supervis√£o de tr√™s assistentes felinos exigentes üòº.<br> Se o app te ajudou, que tal pagar um sach√™ pra eles? Eles v√£o ficar muito felizes!
                            </p>
                        </div>
                        <div class="support-card-col-right">
                             <div id="pix-details">
                                <div class="pix-qr-code-placeholder">
                                    <span>QR Code PIX</span>
                                </div>
                                <p style="font-weight: 500; margin: 12px 0 4px 0;">Ou copie a chave aleat√≥ria:</p>
                                <div class="pix-key-container">
                                    <span id="pix-key-text">escalafacil.contato@gmail.com</span>
                                    <button id="btn-copy-pix" title="Copiar Chave">üìã</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card card-lista">
                <h2>Ferramentas de Desenvolvedor</h2>
                <p class="muted">Use estas op√ß√µes para testar o comportamento da aplica√ß√£o.</p>
                <div class="form-row">
                    <button id="btnReiniciarOnboarding" class="secondary">üîÅ Reiniciar Onboarding</button>
                    <button id="btnHardReset" class="danger">üî• Apagar Todos os Dados (Hard Reset)</button>
                </div>
            </div>
        </section>

        <aside id="editor-toolbox" class="hidden"></aside>
        <button id="editor-toolbox-fab" class="hidden" title="Abrir Barra de Ferramentas">
            <span>üé®</span>
        </button>

    </main>

    <div id="modalBackdrop" class="modal-backdrop hidden">
        <div id="modal" class="modal">
            <h3 id="modalTitle"></h3>
            <div id="modalMessage" style="text-align: left; max-height: 400px; overflow-y: auto; padding-right: 16px;">
            </div>
            <div class="modal-actions" style="margin-top: 24px;">
                <button id="modalCancel" class="secondary">Cancelar</button>
                <button id="modalConfirm" class="primary">‚úì Confirmar</button>
            </div>
        </div>
    </div>

    <div id="exportModalBackdrop" class="modal-backdrop hidden">
        <div id="exportModal" class="modal">
            <h3>Selecione o Formato do PDF</h3>
            <p>Escolha como voc√™ deseja exportar a escala.</p>
            <div class="modal-actions" style="flex-direction: column; gap: 12px; margin-top: 16px;">
                <button id="btnExportVisaoGeral" class="primary">Escala Completa (PDF)</button>
                <button id="btnExportVisaoDiaria" class="primary">Relat√≥rio Di√°rio Detalhado</button>
                <button id="btnExportAmbos" class="primary">Baixar Ambos (.zip)</button>
                <button id="btnExportCancelar" class="secondary" style="margin-top: 8px;">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast hidden">
        <p id="toastMessage"></p>
    </div>

    <div id="loader-overlay" class="hidden">
        <div class="grid-loader">
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
            <div class="grid-cell"></div>
        </div>
        <p class="loader-text">Gerando escala...</p>
        <button id="loader-cancel-btn" class="danger">Cancelar Gera√ß√£o</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <script src="js/shared-utils.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/store.js"></script>
    <script src="js/turnos.js"></script>
    <script src="js/cargos.js"></script>
    <script src="js/funcionarios.js"></script>
    <script src="js/equipes.js"></script>
    <script src="js/gerar-escala-auto.js"></script>
    <script src="js/editor-manual.js"></script>
    <script src="js/escalas-visualizacao.js"></script>
    <script src="js/escalas-gerador.js"></script>
    <script src="js/escalas-salvas.js"></script>
    <script src="js/configuracoes.js"></script>
    <script src="js/welcome.js"></script>
    <script src="js/relatorios.js"></script>
    <script src="js/pdf-export.js"></script>
    <script src="js/main.js"></script>
</body>

</html>